<head>
  <link rel="stylesheet" href="enfermeria.component.css">
</head>

<body>
  <div>
    <h1>Enfermeria </h1>
    <hr>

    <div>
        <form [formGroup]="buscadorForm" (ngSubmit)="buscarPaciente($event)"> 
          <div class="form-row justify-content-start">
            <div class="form-inline">
              <div>
                <mat-form-field appearance="legacy">
                  <mat-label>Paciente id</mat-label>
                  <input matInput type="number" placeholder="Paciente id" 
                        formControlName="pacienteIdBusqueda" id="pacienteIdBusqueda">
                </mat-form-field> 
              </div> 
            </div>
            &nbsp; &nbsp; &nbsp;
            <div class="form-inline">
              <div>
                <mat-form-field appearance="legacy">
                  <mat-label>C&eacute;dula</mat-label>
                  <input matInput type="text" placeholder="C&eacute;dula" 
                        formControlName="cedulaBusqueda" id="cedulaBusqueda">
                </mat-form-field> 
              </div> 
            </div>
            <div class="align-self-center">
              <button type="submit" hidden="true" class="btn btn-success"><i class="fas fa-search"></i> Buscar</button>
            </div>
            <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
            <div>
              <button type="button" class="btn btn-warning" data-toggle="tooltip" data-placement="top" title="Limpiar"
                  (click)="limpiar($event)"><i class="fas fa-backspace"></i></button>
            </div>
            <div>
              <button type="button" class="btn btn-primary" data-toggle="tooltip" data-placement="top" title="Buscador de pacientes"
                  (click)="openModal(editProfileModal)"><i class="fas fa-search"></i></button>
            </div>
          </div>
        </form>
    </div>

    <nav>
      <div class="nav nav-tabs" id="nav-tab" role="tablist">
        <a class="nav-item nav-link active" id="nav-datosP-tab" data-toggle="tab" href="#nav-datosP" role="tab" aria-controls="nav-datosP" aria-selected="true">Datos Personales</a>
        <a class="nav-item nav-link" id="nav-fichaM-tab" data-toggle="tab" href="#nav-fichaM" role="tab" aria-controls="nav-fichaM" aria-selected="false">Ficha M&eacute;dica</a>
        <a class="nav-item nav-link" id="nav-historialC-tab" data-toggle="tab" href="#nav-historialC" role="tab" aria-controls="nav-historialC" aria-selected="false">Historial Cl&iacute;nico</a>
        <a class="nav-item nav-link" id="nav-tratamiento-tab" data-toggle="tab" href="#nav-tratamiento" role="tab" aria-controls="nav-tratamiento" aria-selected="false">Recetas</a>
      </div>
    </nav>

    <div class="tab-content" id="nav-tabContent">
      <div class="tab-pane fade show active" id="nav-datosP" role="tabpanel" aria-labelledby="nav-datosP-tab">
        <div> 
          <!--Modal buscador de pacientes-->
          <div class="row justify-content-center">
            <div class="col-lg-6">
              <div class="container">              
                <div class="row">                
                  <ng-template #editProfileModal let-modal>
                    <div class="modal-header">
                    <h3 class="modal-title" id="editProfileLabel">Buscador Pacientes</h3>
                    <button type="button" class="close" (click)="modal.dismiss()" aria-label="Close">
                          <span aria-hidden="true">&times;</span> 
                    </button>
                    </div>
                    <div *ngIf="alert" class="alert alert-danger alert-dismissible fade show" role="alert">
                          Debe ingresar como m&iacute;nimo un dato de b&uacute;squeda
                          <button type="button" (click)="cerrarAlert()" class="close" data-dismiss="alert" aria-label="Close">
                          <span aria-hidden="true">&times;</span>
                          </button>
                    </div>
                    <div class="modal-body">
                          <form [formGroup]="buscadorModalForm" (ngSubmit)="buscadorPacientes($event)">
                                <div class="form-row justify-content-center">
                                      <div>                                                                                                                                                          
                                            <mat-form-field appearance="legacy">
                                                  <mat-label>C&eacute;dula</mat-label>
                                                  <input matInput type="text" placeholder="C&eacute;dula" 
                                                        formControlName="cedula" id="cedula">
                                            </mat-form-field>                                                                                                                                                         
                                            <mat-form-field appearance="legacy">
                                                  <mat-label>Nombres</mat-label>
                                                  <input matInput type="text" placeholder="Nombres" 
                                                        formControlName="nombres" id="nombres">
                                            </mat-form-field>
                                            <mat-form-field appearance="legacy">
                                                  <mat-label>Apellidos</mat-label>
                                                  <input matInput type="text" placeholder="Apellidos" 
                                                        formControlName="apellidos" id="apellidos">
                                            </mat-form-field>
                                      </div>
                                      &nbsp;                                                                            
                                      <div class="align-self-center">
                                            <button type="submit" hidden="true" class="btn btn-success"><i class="fas fa-search"></i> Buscar</button>
                                            <button (click)="limpiarModal($event)" class="btn btn-warning"><i class="fas fa-backspace"></i> Limpiar</button>                                                                            
                                      </div>
                                </div>
                          </form>
                          <br>

                          <!--Tabla vacia-->
                          <div class="table-responsive table-hover">
                                <table datatable [dtOptions]="dtOptions" class="table-bordered"
                                *ngIf="!cargando && pacientes.length === 0">
                                      <thead>
                                            <tr class="table-primary">
                                                  <th>Id</th>
                                                  <th>C&eacute;dula</th>
                                                  <th>Nombres</th>
                                                  <th>Apellidos</th>
                                            </tr>
                                      </thead>                                                                                    
                                </table>
                          </div>
                          <div class="table-responsive table-hover">
                                <table datatable [dtOptions]="dtOptions" class="table-bordered"
                                      *ngIf="pacientes.length > 0">
                                      <thead>
                                            <tr  class="table-primary">
                                                  <th>Id</th>
                                                  <th>C&eacute;dula</th>
                                                  <th>Nombres</th>
                                                  <th>Apellidos</th>
                                            </tr>
                                      </thead>
                                      <tbody *ngIf="pacientes?.length != 0">
                                            <tr *ngFor="let paciente of pacientes" 
                                                  (click)="selectPaciente($event, paciente)">                                                                                                
                                                  <td>{{ paciente.pacienteId }}</td>
                                                  <td>{{ paciente.personas.cedula }}</td>
                                                  <td>{{ paciente.personas.nombres }}</td>
                                                  <td>{{ paciente.personas.apellidos }}</td>
                                            </tr>
                                      </tbody>
                                      <tbody *ngIf="cargando">
                                            <td></td>
                                            <td></td>
                                            <td><h4 class="alert-heading">Cargando</h4>
                                                  <p>
                                                        <i class="fa fa-sync-alt fa-spin fa-2x"></i>
                                                  </p>
                                                  <p class="mb-0">
                                                        Espere por favor
                                                  </p>
                                            </td>
                                            <td></td>
                                      </tbody>                                                                                    
                                </table>
                          </div>
                          <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" (click)="modal.dismiss()">Cerrar</button>
                          </div>
                    </div>
                  </ng-template>                             
                </div>
              </div>              
            </div>          
          </div>
          <br>
          <!-- Datos paciente-->
          <div class="row justify-content-center">
            <div class="col-lg-5">
              <div class="container">              
                <div class="row">                
                  <div class="col"><b>Persona id:</b></div>
                  <div class="col">{{pacienteForm.get('personas').get('personaId').value}}</div>
                  <div class="w-100"></div>
                  <div class="col"><b>Nombres:</b></div>
                  <div class="col">{{pacienteForm.get('personas').get('nombres').value}}</div>
                  <div class="w-100"></div>
                  <div class="col"><b>Apellidos:</b></div>
                  <div class="col">{{pacienteForm.get('personas').get('apellidos').value}}</div>
                  <div class="w-100"></div>
                  <div class="col"><b>Fecha nacimiento:</b></div>
                  <div class="col">{{pacienteForm.get('personas').get('fechaNacimiento').value}}</div>
                  <div class="w-100"></div>
                  <div class="col"><b>Edad:</b></div>
                  <div class="col">{{pacienteForm.get('personas').get('edad').value}}</div>
                  <div class="w-100"></div>
                  <div class="col"><b>Sexo:</b></div>
                  <div class="col">{{pacienteForm.get('personas').get('sexo').value}}</div>                
                </div>
              </div>              
            </div>

            <div class="col-lg-5">
              <div class="container">
                <div class="row">                
                  <div class="col"><b>Estado Civil:</b></div>
                  <div class="col">{{pacienteForm.get('personas').get('estadoCivil').value}}</div>
                  <div class="w-100"></div>
                  <div class="col"><b>Nacionalidad:</b></div>
                  <div class="col">{{pacienteForm.get('personas').get('nacionalidad').value}}</div>
                  <div class="w-100"></div>                
                  <div class="col"><b>Carrera:</b></div>
                  <div class="col">{{pacienteForm.get('personas').get('carreraId').value}}</div>
                  <div class="w-100"></div>
                  <div class="col"><b>Departamento:</b></div>
                  <div class="col">{{pacienteForm.get('personas').get('departamentoId').value}}</div>
                  <div class="w-100"></div>
                  <div class="col"><b>Dependencia:</b></div>
                  <div class="col">{{pacienteForm.get('personas').get('dependenciaId').value}}</div>
                  <div class="w-100"></div>
                  <div class="col"><b>Estamento:</b></div>
                  <div class="col">{{pacienteForm.get('personas').get('estamentoId').value}}</div>                
                </div>   
              </div>         
            </div>

            <div class="col-lg-2">
              <div class="container">
                <div class="row">                
                  <img src="../assets/images/user-circle-solid.svg" alt="..." class="img-thumbnail">                               
                </div>   
              </div>         
            </div>

          </div>
        </div>
        <br><br>     
          
        <div class="card">
          <h3 class="card-header" data-toggle="collapse" data-target="#collapseBuscador"
              aria-expanded="true" aria-controls="collapseBuscador">Direcciones y contactos</h3>  
          <div class="card-body collapse show" id="collapseBuscador">
            <div class="row justify-content-center">
              <div class="col-lg-6">
                <div class="col"><b>Direcci&oacute;n:</b></div>
                <div class="col">{{pacienteForm.get('personas').get('direccion').value}}</div>
                <div class="w-100"></div>
                <div class="col"><b>Tel&eacute;fono:</b></div>
                <div class="col">{{pacienteForm.get('personas').get('telefono').value}}</div>
                <div class="w-100"></div>
                <div class="col"><b>Celular:</b></div>
                <div class="col">{{pacienteForm.get('personas').get('celular').value}}</div>
                <div class="w-100"></div>
                <div class="col"><b>Email:</b></div>
                <div class="col">{{pacienteForm.get('personas').get('email').value}}</div>
              </div>

              <div class="col-lg-6">
                <div class="form-group">
                  <label><b>Observaciones: </b></label>
                  <textarea class="form-control" id="exampleFormControlTextarea1" rows="3"></textarea>
                </div>
              </div>

            </div>
          </div>
        </div>
        <br>
        <br>
      </div>
      <div class="tab-pane fade" id="nav-fichaM" role="tabpanel" aria-labelledby="nav-fichaM-tab">
        <br>
        <!-- Datos paciente-->
        <div class="row justify-content-center">
          <div class="col-lg-5">
            <div class="container">              
              <div class="row">                
                <div class="col"><b>Paciente id:</b></div>
                <div class="col">{{pacienteForm.get('pacienteId').value}}</div>
                <div class="w-100"></div>
                <div class="col"><b>Grupo Sanguineo:</b></div>
                <div class="col">{{pacienteForm.get('grupoSanguineo').value}}</div>
                <div class="w-100"></div>
                <div class="col"><b>Seguro medico:</b></div>
                <div class="col">{{pacienteForm.get('seguroMedico').value}}</div>                              
              </div>
            </div>              
          </div>

          <div class="col-lg-5">
            <div class="container">
               
            </div>         
          </div>

          <div class="col-lg-2">
            <div class="container">
               
            </div>         
          </div>

        </div>
        <br>
        <div class="card">
          <h3 class="card-header" data-toggle="collapse" data-target="#collapsePatologias"
              aria-expanded="true" aria-controls="collapsePatologias">Patologias y tratamientos</h3>  
          <div class="card-body collapse show" id="collapsePatologias">
            <div class="table-responsive table-hover">
              <table datatable [dtOptions]="dtOptionsPatologias" class="table table-sm" 
                *ngIf="patologiasProcedimientos.length > 0">
                <thead>
                  <tr class="table-primary">
                    <th scope="col">#</th>
                    <th scope="col">Id</th>
                    <th scope="col">Patologia</th>
                    <th scope="col">Tratamiento</th>
                    <th scope="col">Estado</th>                    
                    <th scope="col">Editar</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let patologia of patologiasProcedimientos; let i = index">
                    <th scope="row">{{ i + 1 }}</th>
                    <td>{{ patologia.patologiaId }}</td>
                    <td>{{ patologia.codigo }}</td>
                    <td>{{ patologia.descripcion }}</td>
                    <td>{{ patologia.estado }}</td>        
                    <td>
                      <a class="btn btn-info"
                              [routerLink]="['/patologia', patologia.patologiaId ]">
                        <i class="fa fa-edit"></i>
                      </a>
                    </td>                   
                  </tr>
                </tbody>
                <tbody *ngIf="cargando" class="alert alert-light text-center mt-3 animated fadeIn faster">
                  <td></td>
                  <td></td>       
                  <td>
                    <h4 class="alert-heading">Cargando</h4>
                    <p>
                      <i class="fa fa-sync-alt fa-spin fa-2x"></i>
                    </p>
                    <p class="mb-0">
                      Espere por favor
                    </p>
                  </td>
                  <td></td>
                  <td></td>
                  <td></td>                       
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <br>
        <div class="card">
          <h3 class="card-header" data-toggle="collapse" data-target="#collapseAntecedentes"
              aria-expanded="true" aria-controls="collapseAntecedentes">Antecedentes de infecciones y procedimientos</h3>  
          <div class="card-body collapse show" id="collapseAntecedentes">
            <div class="table-responsive table-hover">
              <table datatable [dtOptions]="dtOptionsAntecedentes" class="table table-sm" 
                *ngIf="antecedentes.length > 0">
                <thead>
                  <tr class="table-primary">
                    <th scope="col">#</th>
                    <th scope="col">Id</th>
                    <th scope="col">Patologia</th>
                    <th scope="col">Tratamiento</th>
                    <th scope="col">Estado</th>                    
                    <th scope="col">Editar</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let antecedente of antecedentes; let i = index">
                    <th scope="row">{{ i + 1 }}</th>
                    <td>{{ antecedente.patologiaId }}</td>
                    <td>{{ antecedente.codigo }}</td>
                    <td>{{ antecedente.descripcion }}</td>
                    <td>{{ antecedente.estado }}</td>        
                    <td>
                      <a class="btn btn-info"
                              [routerLink]="['/antecedente', antecedente.antecedenteId ]">
                        <i class="fa fa-edit"></i>
                      </a>
                    </td>                   
                  </tr>
                </tbody>
                <tbody *ngIf="cargando" class="alert alert-light text-center mt-3 animated fadeIn faster">
                  <td></td>
                  <td></td>       
                  <td>
                    <h4 class="alert-heading">Cargando</h4>
                    <p>
                      <i class="fa fa-sync-alt fa-spin fa-2x"></i>
                    </p>
                    <p class="mb-0">
                      Espere por favor
                    </p>
                  </td>
                  <td></td>
                  <td></td>
                  <td></td>                       
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <br>
        <div class="card">
          <h3 class="card-header" data-toggle="collapse" data-target="#collapseAlergias"
              aria-expanded="true" aria-controls="collapseAlergias">Alergias</h3>  
          <div class="card-body collapse show" id="collapseAlergias">
            <div class="table-responsive table-hover">
              <table datatable [dtOptions]="dtOptionsAlergias" class="table table-sm" 
                *ngIf="alergias.length > 0">
                <thead>
                  <tr class="table-primary">
                    <th scope="col">#</th>
                    <th scope="col">Id</th>
                    <th scope="col">Patologia</th>
                    <th scope="col">Tratamiento</th>
                    <th scope="col">Estado</th>                    
                    <th scope="col">Editar</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let alergia of alergias; let i = index">
                    <th scope="row">{{ i + 1 }}</th>
                    <td>{{ alergia.patologiaId }}</td>
                    <td>{{ alergia.codigo }}</td>
                    <td>{{ alergia.descripcion }}</td>
                    <td>{{ alergia.estado }}</td>        
                    <td>
                      <a class="btn btn-info"
                              [routerLink]="['/alergia', alergia.alergiaId ]">
                        <i class="fa fa-edit"></i>
                      </a>
                    </td>                   
                  </tr>
                </tbody>
                <tbody *ngIf="cargando" class="alert alert-light text-center mt-3 animated fadeIn faster">
                  <td></td>
                  <td></td>       
                  <td>
                    <h4 class="alert-heading">Cargando</h4>
                    <p>
                      <i class="fa fa-sync-alt fa-spin fa-2x"></i>
                    </p>
                    <p class="mb-0">
                      Espere por favor
                    </p>
                  </td>
                  <td></td>
                  <td></td>
                  <td></td>                       
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <br>
      </div>
      <div class="tab-pane fade" id="nav-historialC" role="tabpanel" aria-labelledby="nav-historialC-tab">
        <br>
        <div class="row justify-content-center">
          <div class="col-lg-5">
            <div class="container">              
              <div class="row">                
                <div class="col"><b>Historial clinico id:</b></div>
                <div class="col">{{historialClinicoForm.get('pacientes').get('pacienteId').value}}</div>
                <div class="w-100"></div>
                <div class="col"><b>Area:</b></div>
                <div class="col">{{historialClinicoForm.get('areaId').value}}</div>                                               
              </div>
            </div>              
          </div>

          <div class="col-lg-5">
            <div class="container">
               
            </div>         
          </div>

          <div class="col-lg-2">
            <div class="container">
               
            </div>         
          </div>

        </div>
        <br>
        <div class="card">
          <h3 class="card-header" data-toggle="collapse" data-target="#collapseHistorialClinico"
              aria-expanded="true" aria-controls="collapseHistorialClinico">Historial clinico</h3>  
          <div class="card-body collapse show" id="collapseHistorialClinico">
            
          </div>
        </div>
        <br>
        <div class="card">
          <h3 class="card-header" data-toggle="collapse" data-target="#collapseHistorialDigitalizado"
              aria-expanded="true" aria-controls="collapseHistorialClinicoDigitalizado">Historial Clinico digitalizado</h3>  
          <div class="card-body collapse show" id="collapseHistorialClinicoDigitalizado">
            
          </div>
        </div>
        <br>        
      </div>
      <div class="tab-pane fade" id="nav-tratamiento" role="tabpanel" aria-labelledby="nav-tratamiento-tab">
        ...
      </div>
    </div>
  </div>
</body>